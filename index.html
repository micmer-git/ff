<!DOCTYPE html>
<html lang="it" id="root">
<head>
  <meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
  <title>futuro fortissimo â€“ explorer</title>

  <!-- Fonts & Tailwind -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Playfair+Display:ital@700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter', 'system-ui']
          },
          colors: {
            bg: '#f6f9fe',
            acc: '#38bdf8'
          }
        }
      }
    }
  </script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent }
    body { font-family: Inter, sans-serif; background: var(--tw-bg-opacity) bg; color: #111; overflow: hidden }
    mark { background: #38bdf8; color: #fff; padding: 0 3px; border-radius: 3px }
    .pill, .tag { background: #fff; padding: 4px 13px; border-radius: 9999px; cursor: pointer; user-select: none; transition: .2s }
    .pill { font-size: 1.2rem }
    .pill.active { outline: 2px solid #38bdf8 }
    .tag { font-size: .85rem; margin-top: 4px; margin-right: 4px }
    #canvas { scroll-snap-type: y mandatory; overflow-y: auto; -webkit-overflow-scrolling: touch }
    .page { min-height: calc(100vh - 120px); scroll-snap-align: start; display: flex; align-items: center; padding-left: 6vw }
    .box { width: calc(100% - 12vw); max-width: 720px; max-height: 78vh; overflow-y: auto; padding: 2rem 1.7rem }
    .box::-webkit-scrollbar { display: none }
    .box h3 { font-size: 1.35rem; font-weight: 700; margin-bottom: .4rem }
    .box p { font-size: 1.15rem; line-height: 1.6; margin-bottom: .65rem }
    .box.book h3 { font-size: 1.15rem }
    .src { font-size: .8rem; color: #555; margin-top: .3rem }
  </style>
</head>

<body>
  <!-- HEADER -->
  <header class="fixed inset-x-0 top-0 h-[60px] px-[6vw] flex items-center justify-between z-30">
    <div class="flex items-center gap-2">
      <img src="logo.png" class="h-8">
      <h1 class="font-[Playfair_Display] italic text-[1.55rem]">futuro&nbsp;fortissimo</h1>
    </div>
    <div id="cta" class="flex items-center gap-4 text-[2rem]">
      <span id="ctaCoffee">â˜•</span><span id="ctaAbout">ğŸ‘¤</span>
      <span id="langBtn" class="cursor-pointer">ğŸ‡¬ğŸ‡§</span>
    </div>
  </header>

  <!-- SIDE EMOJI BAR -->
  <aside id="side" class="fixed top-[60px] bottom-[60px] right-0 w-[46px] flex flex-col items-center gap-2 pt-3 overflow-y-auto">
  </aside>

  <!-- CANVAS -->
  <main id="canvas" class="fixed top-[60px] bottom-[60px] right-[46px] left-0"></main>

  <!-- SEARCH -->
  <footer class="fixed inset-x-0 bottom-0 h-[60px] bg-bg flex items-center px-[6vw] gap-3">
    <input id="search" placeholder="cerca / searchâ€¦" class="flex-1 rounded-full border-2 border-black px-4 py-2 text-lg outline-none">
    <button id="searchBtn" class="text-[1.8rem] text-acc">ğŸ”</button>
  </footer>

  <script>
Â  Â  /* -------- data paths -------- */
Â  Â  const PATH = { it: 'newsletter_data.json', en: 'newsletter_data_en.json' },
Â  Â  Â  Â  Â  NOTES = 'notes.json', BOOKS = 'books.json';

Â  Â  /* -------- state -------- */
Â  Â  let PUBS, NOTESARR, BOOKSARR, LANG = 'it', q = '';
Â  Â  const selTags = new Set();
Â  Â  const gradients = [
Â  Â  Â  'linear-gradient(135deg,#38bdf8,#c084fc)',
Â  Â  Â  'linear-gradient(135deg,#f472b6,#facc15)',
Â  Â  Â  'linear-gradient(135deg,#34d399,#60a5fa)',
Â  Â  Â  'linear-gradient(135deg,#f87171,#fb923c)',
Â  Â  Â  'linear-gradient(135deg,#a78bfa,#f472b6)',
Â  Â  Â  'linear-gradient(135deg,#fb923c,#fde68a)',
Â  Â  Â  'linear-gradient(135deg,#5eead4,#3b82f6)',
Â  Â  Â  'linear-gradient(135deg,#fda4af,#c4b5fd)'
Â  Â  ];
Â  Â  const allTags = ['ğŸ“š','ğŸ¶','ğŸ’»','ğŸƒ','â¤ï¸','ğŸ’¸','âš½','ğŸ½','ğŸ§ ','ğŸ’Š','ğŸ¨','ğŸš•','ğŸ¥½','ğŸ‘¥','ğŸ’†'];

Â  Â  /* -------- helpers -------- */
Â  Â  const $ = s => document.querySelector(s),
Â  Â  Â  Â  Â  rnd = a => a.sort(() => Math.random() - .5),
Â  Â  Â  Â  Â  match = (t) => t.includes(q),
Â  Â  Â  Â  Â  mark = (t) => q ? t.replace(new RegExp(`(${q})`, 'gi'), '<mark>$1</mark>') : t,
Â  Â  Â  Â  Â  pg = (c) => { const p = document.createElement('section'); p.className = 'page'; p.appendChild(c); return p },
Â  Â  Â  Â  Â  openNew = u => window.open(u, '_blank');

Â  Â  /* -------- build side tags -------- */
Â  Â  const side = $('#side');
Â  Â  allTags.forEach(t => {
Â  Â  Â  const el = document.createElement('div');
Â  Â  Â  el.textContent = t;
Â  Â  Â  el.className = 'pill';
Â  Â  Â  el.onclick = () => {
Â  Â  Â  Â  el.classList.toggle('active');
Â  Â  Â  Â  if (selTags.has(t)) selTags.delete(t);
Â  Â  Â  Â  else selTags.add(t);
Â  Â  Â  Â  render();
Â  Â  Â  };
Â  Â  Â  side.appendChild(el);
Â  Â  });

Â  Â  /* -------- CTA & lang -------- */
Â  Â  $('#ctaCoffee').onclick = () => openNew('https://www.paypal.com/paypalme/michelemerelli');
Â  Â  $('#ctaAbout').onclick = () => openNew('https://linktr.ee/micmer');
Â  Â  $('#langBtn').onclick = () => {
Â  Â  Â  LANG = LANG === 'it' ? 'en' : 'it';
Â  Â  Â  $('#langBtn').textContent = LANG === 'it' ? 'ğŸ‡¬ğŸ‡§' : 'ğŸ‡®ğŸ‡¹';
Â  Â  Â  loadData();
Â  Â  };

Â  Â  /* -------- search -------- */
Â  Â  const sInp = $('#search');
Â  Â  sInp.oninput = () => { q = sInp.value.trim().toLowerCase(); render(); };
Â  Â  $('#searchBtn').onclick = () => {
Â  Â  Â  sInp.blur();
Â  Â  Â  q = sInp.value.trim().toLowerCase();
Â  Â  Â  render();
Â  Â  };

Â  Â  /* -------- load data -------- */
Â  Â  function loadData() {
Â  Â  Â  Promise.all([
Â  Â  Â  Â  fetch(PATH[LANG]).then(r => r.json()),
Â  Â  Â  Â  fetch(NOTES).then(r => r.json()),
Â  Â  Â  Â  fetch(BOOKS).then(r => r.json())
Â  Â  Â  ]).then(([d, n, b]) => {
Â  Â  Â  Â  PUBS = rnd(d.publications); // Randomize publications only once on load
Â  Â  Â  Â  NOTESARR = n.notes.map(o => ({ ...o, tags: ['ğŸ¶'] }));
Â  Â  Â  Â  BOOKSARR = b.map(o => ({ ...o, tags: ['ğŸ“š'] }));
Â  Â  Â  Â  selTags.clear();
Â  Â  Â  Â  document.querySelectorAll('#side .pill.active').forEach(p => p.classList.remove('active'));
Â  Â  Â  Â  q = '';
Â  Â  Â  Â  sInp.value = '';
Â  Â  Â  Â  render();
Â  Â  Â  });
Â  Â  }

Â  Â  /* -------- factories -------- */
Â  Â  function pubCard(p, s, hi) {
Â  Â  Â  const c = document.createElement('div');
Â  Â  Â  c.className = 'box';
Â  Â  Â  c.style.background = '#fff';
Â  Â  Â  c.innerHTML = `<h3>${hi ? mark(s.title) : s.title}</h3>` +
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  s.contentBlocks[0].content.map(l => `<p>${hi ? mark(l) : l}</p>`).join('');
Â  Â  Â  c.onclick = () => openNew(p.substackLink);
Â  Â  Â  return pg(c);
Â  Â  }
Â  Â  function bookCard(b, hi) {
Â  Â  Â  const c = document.createElement('div');
Â  Â  Â  c.className = 'box book';
Â  Â  Â  c.style.background = '#fff';
Â  Â  Â  c.innerHTML = `<h3>${hi ? mark(b.title) : b.title}</h3><p>${hi ? mark(b.text) : b.text}</p><p class="src">${b.book} â€” ${b.author}</p>`;
Â  Â  Â  if (b.url) c.onclick = () => openNew(b.url);
Â  Â  Â  return pg(c);
Â  Â  }
Â  Â  function noteCard(n, hi) {
Â  Â  Â  const host = n.url ? new URL(n.url).hostname.replace(/^www\./, '') : '';
Â  Â  Â  const c = document.createElement('div');
Â  Â  Â  c.className = 'box';
Â  Â  Â  c.style.background = '#fff';
Â  Â  Â  c.innerHTML = `<h3>${hi ? mark(n.title) : n.title}</h3>${host ? `<p class="src">${host}</p>` : ''}`;
Â  Â  Â  if (n.url) c.onclick = () => openNew(n.url);
Â  Â  Â  return pg(c);
Â  Â  }

Â  Â  /* -------- render -------- */
Â  Â  function render() {
Â  Â  Â  const cv = $('#canvas');
Â  Â  Â  cv.innerHTML = '';
Â  Â  Â  const activeFilter = selTags.size,
Â  Â  Â  Â  Â  Â  qOn = q.length > 0;
Â  Â  Â  let stack = [];

Â  Â  Â  // home = all content
Â  Â  Â  if (!activeFilter && !qOn) {
Â  Â  Â  Â  PUBS.forEach(p =>Â 
Â  Â  Â  Â  Â  p.cards
Â  Â  Â  Â  Â  Â .filter(c => !c.title.startsWith('ğŸ“–'))
Â  Â  Â  Â  Â  Â .forEach(c => stack.push(pubCard(p, c, false)))
Â  Â  Â  Â  );
Â  Â  Â  Â  BOOKSARR.forEach(b => stack.push(bookCard(b, false)));
Â  Â  Â  Â  NOTESARR.forEach(n => stack.push(noteCard(n, false)));
Â  Â  Â  Â  rnd(stack).forEach(el => cv.appendChild(el)); // Apply random order when no filters are active
Â  Â  Â  }
Â  Â  Â  // tag filter
Â  Â  Â  else if (activeFilter && !qOn) {
Â  Â  Â  Â  if (selTags.size === 1 && selTags.has('ğŸ“š')) {
Â  Â  Â  Â  Â  stack = BOOKSARR.map(b => bookCard(b, false));
Â  Â  Â  Â  }
Â  Â  Â  Â  else if (selTags.size === 1 && selTags.has('ğŸ¶')) {
Â  Â  Â  Â  Â  stack = NOTESARR.map(n => noteCard(n, false));
Â  Â  Â  Â  }
Â  Â  Â  Â  else {
Â  Â  Â  Â  Â  PUBS.forEach(p =>Â 
Â  Â  Â  Â  Â  Â  p.cards
Â  Â  Â  Â  Â  Â  Â .filter(c => !c.title.startsWith('ğŸ“–') && c.tags?.some(t => selTags.has(t)))
Â  Â  Â  Â  Â  Â  Â .forEach(c => stack.push(pubCard(p, c, false)))
Â  Â  Â  Â  Â  );
Â  Â  Â  Â  }
Â  Â  Â  Â  stack.forEach(el => cv.appendChild(el)); // No randomization for filtered results
Â  Â  Â  }
Â  Â  Â  // search (with or w/out tag)
Â  Â  Â  else {
Â  Â  Â  Â  PUBS.forEach(p =>Â 
Â  Â  Â  Â  Â  p.cards
Â  Â  Â  Â  Â  Â .filter(c => {
Â  Â  Â  Â  Â  Â  Â const tagOk = !activeFilter || c.tags?.some(t => selTags.has(t));
Â  Â  Â  Â  Â  Â  Â const textOk = match((c.title + c.contentBlocks[0].content.join(' ')).toLowerCase());
Â  Â  Â  Â  Â  Â  Â return !c.title.startsWith('ğŸ“–') && tagOk && textOk;
Â  Â  Â  Â  Â  Â })
Â  Â  Â  Â  Â  Â .forEach(c => stack.push(pubCard(p, c, true)))
Â  Â  Â  Â  );
Â  Â  Â  Â  BOOKSARR.forEach(b => {
Â  Â  Â  Â  Â  if ((!activeFilter || selTags.has('ğŸ“š')) && match((b.title + b.text).toLowerCase())) {
Â  Â  Â  Â  Â  Â  stack.push(bookCard(b, true));
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });
Â  Â  Â  Â  NOTESARR.forEach(n => {
Â  Â  Â  Â  Â  if ((!activeFilter || selTags.has('ğŸ¶')) && match(n.title.toLowerCase())) {
Â  Â  Â  Â  Â  Â  stack.push(noteCard(n, true));
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });
Â  Â  Â  Â  stack.forEach(el => cv.appendChild(el)); // No randomization for filtered/searched results
Â  Â  Â  }

Â  Â  Â  // â†â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“
Â  Â  Â  // Fallback: If no cards matched filters/search, show â€œhomeâ€ content anyway
Â  Â  Â  if (stack.length === 0) {
Â  Â  Â  Â  PUBS.forEach(p =>Â 
Â  Â  Â  Â  Â  p.cards
Â  Â  Â  Â  Â  Â .filter(c => !c.title.startsWith('ğŸ“–'))
Â  Â  Â  Â  Â  Â .forEach(c => stack.push(pubCard(p, c, false)))
Â  Â  Â  Â  );
Â  Â  Â  Â  BOOKSARR.forEach(b => stack.push(bookCard(b, false)));
Â  Â  Â  Â  NOTESARR.forEach(n => stack.push(noteCard(n, false)));
Â  Â  Â  Â  rnd(stack).forEach(el => cv.appendChild(el)); // Apply random order for fallback content
Â  Â  Â  }
Â  Â  Â  // â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â†’

Â  Â  Â  cv.scrollTo(0, 0);
Â  Â  }

Â  Â  loadData();
Â  </script>
</body>
</html>
