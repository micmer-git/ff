<!DOCTYPE html><html lang="it">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>futuro fortissimo ‚Äì explorer</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">

<style>
:root{
 --bg:#f6f9fe;--fg:#111;--acc:#38bdf8;
 --hdr:60px;--srch:60px;--cta:50px;--gut:54px;
}
*{box-sizing:border-box;margin:0;padding:0;-webkit-tap-highlight-color:transparent}
body{height:100%;font-family:Inter,sans-serif;background:var(--bg);color:var(--fg);overflow:hidden}
a,button{all:unset;cursor:pointer}
mark{background:var(--acc);color:#fff;border-radius:3px;padding:0 3px}

/* header */
header{position:fixed;inset:0 auto auto 0;height:var(--hdr);width:100%;
       display:flex;align-items:center;justify-content:space-between;
       padding:0 6vw;background:var(--bg);z-index:25}
#logoWrap{display:flex;align-items:center;gap:.55rem}
#logoWrap img{height:34px}#logoWrap h1{font-size:1.45rem;font-style:italic;font-weight:700}
#ctaHead{display:flex;gap:.9rem;font-size:1.7rem}

/* side tags */
#gutter{position:fixed;top:var(--hdr);bottom:calc(var(--srch)+var(--cta));
        right:0;width:var(--gut);display:flex;flex-direction:column;
        align-items:center;gap:.55rem;padding-top:.7rem;overflow-y:auto}
.tag{font-size:1.55rem;padding:.15rem;border-radius:50%;cursor:pointer}
.tag.active,.tag:hover{background:var(--acc);color:#fff}

/* canvas */
#canvas{position:fixed;top:var(--hdr);left:0;right:var(--gut);
        bottom:calc(var(--srch)+var(--cta));overflow-y:auto;
        scroll-snap-type:y mandatory;-webkit-overflow-scrolling:touch}
.page{min-height:calc(100vh - var(--hdr) - var(--srch) - var(--cta));
      display:flex;align-items:center;justify-content:center;
      padding:0 6vw;scroll-snap-align:start}
.box{max-width:620px;width:100%;max-height:78vh;overflow-y:auto;
     padding:2.2rem 1.9rem}
.box::-webkit-scrollbar{display:none}
.box h2{font-size:1.55rem;font-weight:700;margin-bottom:.7rem;text-wrap:balance}
.box h3{font-size:1.38rem;font-weight:700;margin:.45rem 0 .35rem}
.box p{font-size:1.18rem;line-height:1.6;margin-bottom:.85rem}
.src{font-size:.8rem;color:#555;margin-top:.35rem}

/* search bar */
#searchWrap{position:fixed;left:0;right:0;bottom:var(--cta);height:var(--srch);
            background:var(--bg);display:flex;align-items:center;
            padding:0 6vw;z-index:20}
#search{flex:1;border-bottom:2px solid var(--fg);font-size:1.25rem;
        padding:.35rem .05rem;background:transparent;outline:none}

/* footer CTA bottom */
footer{position:fixed;inset:auto 0 0 0;height:var(--cta);background:var(--bg);
       display:flex;justify-content:center;align-items:center;gap:1.1rem;z-index:20}
.cta{font-size:1.4rem;padding:.2rem 1.3rem;border-radius:9999px;cursor:pointer}
.cta:hover{background:var(--acc);color:#fff}
</style>
</head>
<body>

<header>
  <div id="logoWrap"><img src="logo.png" alt="logo"><h1>futuro&nbsp;fortissimo</h1></div>
  <div id="ctaHead">
    <div onclick="openNew('https://www.paypal.com/paypalme/michelemerelli')">‚òï</div>
    <div onclick="openNew('https://linktr.ee/micmer')">üë§</div>
  </div>
</header>

<div id="gutter"></div>
<div id="canvas"></div>
<div id="searchWrap"><input id="search" placeholder="cerca / search‚Ä¶"></div>

<footer>
  <div class="cta" onclick="openNew('https://futurofortissimo.github.io')">üåê sito</div>
</footer>

<script>
/* ---------- data paths ---------- */
const PATH={it:'newsletter_data.json',en:'newsletter_data_en.json'},
      NOTES_PATH='notes.json',BOOKS_PATH='books.json';

/* ---------- state ---------- */
let PUBS,NOTES,BOOKS;let q='',tags=new Set();

/* ---------- helpers ---------- */
const $=s=>document.querySelector(s),
      rnd=a=>a.sort(()=>Math.random()-.5),
      match=t=>t.includes(q),
      hl=t=>q?t.replace(new RegExp(`(${q})`,'gi'),'<mark>$1</mark>'):t,
      mkPage=c=>{const p=document.createElement('section');p.className='page';p.appendChild(c);return p;},
      openNew=u=>window.open(u,'_blank'),
      allTags=['üìö','üé∂','üíª','üçÉ','‚ù§Ô∏è','üí∏','‚öΩ','üçΩ','üß†','üíä','üé®','üöï','ü•Ω','üë•','üíÜ'];

/* ---------- build side tags ---------- */
const gut=$('#gutter');
allTags.forEach(e=>{
  const d=document.createElement('div');d.textContent=e;d.className='tag';
  d.onclick=()=>{d.classList.toggle('active');tags.has(e)?tags.delete(e):tags.add(e);render();}
  gut.appendChild(d);
});

/* search field */
$('#search').oninput=e=>{q=e.target.value.trim().toLowerCase();render();};

/* load data */
Promise.all([
 fetch(PATH.it).then(r=>r.json()),
 fetch(NOTES_PATH).then(r=>r.json()),
 fetch(BOOKS_PATH).then(r=>r.json())
]).then(([d,n,b])=>{
 PUBS=rnd(d.publications);
 NOTES=rnd(n.notes).map(o=>({...o,tags:['üé∂']}));
 BOOKS=rnd(b).map(o=>({...o,tags:['üìö']}));
 render();
});

/* tag filtering helpers */
const okTag=o=>tags.size?o.tags?.some(t=>tags.has(t)):true;

/* ---------- rendering ---------- */
function render(){
  const C=$('#canvas');C.innerHTML='';
  let stack=[];

  /* --- search --- */
  if(q){
    PUBS.forEach(p=>p.cards.filter(c=>!c.title.startsWith('üìñ')&&okTag(c)&&match((p.title+c.title+c.contentBlocks[0].content.join(' ')).toLowerCase()))
      .forEach(c=>stack.push(pubCard(p,c,true))));
    BOOKS.forEach(b=>{const txt=(b.title+b.text).toLowerCase();
      if(match(txt)&&okTag(b))stack.push(bookCard(b,true));});
    NOTES.forEach(n=>{const txt=(n.title+(n.description||'')).toLowerCase();
      if(match(txt)&&okTag(n))stack.push(noteCard(n,true));});
    rnd(stack).forEach(p=>C.appendChild(p));return;
  }

  /* --- tag filter only --- */
  if(tags.size){
    if(tags.size===1&&tags.has('üìö')){BOOKS.forEach(b=>C.appendChild(bookCard(b,false)));return;}
    if(tags.size===1&&tags.has('üé∂')){NOTES.forEach(n=>C.appendChild(noteCard(n,false)));return;}
    PUBS.forEach(p=>p.cards.filter(c=>!c.title.startsWith('üìñ')&&okTag(c))
         .forEach(c=>stack.push(pubCard(p,c,false))));
    rnd(stack).forEach(p=>C.appendChild(p));return;
  }

  /* --- home random stream --- */
  PUBS.forEach(p=>p.cards.filter(c=>!c.title.startsWith('üìñ'))
       .forEach(c=>stack.push(pubCard(p,c,false))));
  BOOKS.forEach(b=>stack.push(bookCard(b,false)));
  NOTES.forEach(n=>stack.push(noteCard(n,false)));
  rnd(stack).forEach(p=>C.appendChild(p));
}

/* ---------- card builders ---------- */
function pubCard(pub,sub,hi){
  const b=document.createElement('div');b.className='box';
  b.innerHTML=`<h3>${hi?hl(sub.title):sub.title}</h3>`+
              sub.contentBlocks[0].content.map(t=>`<p>${hi?hl(t):t}</p>`).join('');
  b.onclick=()=>openNew(pub.substackLink);return mkPage(b);
}
function bookCard(o,hi){
  const b=document.createElement('div');b.className='box';
  b.innerHTML=`<h2>${hi?hl(o.title):o.title}</h2>
               <p>${hi?hl(o.text):o.text}</p>
               <p class="src">${o.book} ‚Äî ${o.author}</p>`;
  if(o.url)b.onclick=()=>openNew(o.url);return mkPage(b);
}
function noteCard(n,hi){
  const host=n.url?new URL(n.url).hostname.replace(/^www\./,''):'';
  const b=document.createElement('div');b.className='box';
  b.innerHTML=`<h2>${hi?hl(n.title):n.title}</h2>${host?`<p class="src">${host}</p>`:''}`;
  if(n.url)b.onclick=()=>openNew(n.url);return mkPage(b);
}
</script>
</body>
</html>